<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>二进制位运算符 | 博客</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="关均江的博客">
    
    <link rel="preload" href="/website/assets/css/0.styles.b8bf81b3.css" as="style"><link rel="preload" href="/website/assets/js/app.e9cfb13d.js" as="script"><link rel="preload" href="/website/assets/js/2.9fa17cc6.js" as="script"><link rel="preload" href="/website/assets/js/117.8d5581c2.js" as="script"><link rel="prefetch" href="/website/assets/js/10.02a21090.js"><link rel="prefetch" href="/website/assets/js/100.cc9efe78.js"><link rel="prefetch" href="/website/assets/js/101.54e88822.js"><link rel="prefetch" href="/website/assets/js/102.45a2f8d1.js"><link rel="prefetch" href="/website/assets/js/103.25b15e6c.js"><link rel="prefetch" href="/website/assets/js/104.a95e3d1e.js"><link rel="prefetch" href="/website/assets/js/105.66e8fb54.js"><link rel="prefetch" href="/website/assets/js/106.5014b60c.js"><link rel="prefetch" href="/website/assets/js/107.26997708.js"><link rel="prefetch" href="/website/assets/js/108.c2c1b5d7.js"><link rel="prefetch" href="/website/assets/js/109.795858d5.js"><link rel="prefetch" href="/website/assets/js/11.98adef37.js"><link rel="prefetch" href="/website/assets/js/110.3f8736cf.js"><link rel="prefetch" href="/website/assets/js/111.a6e8bced.js"><link rel="prefetch" href="/website/assets/js/112.e1446147.js"><link rel="prefetch" href="/website/assets/js/113.95a519a0.js"><link rel="prefetch" href="/website/assets/js/114.e815f494.js"><link rel="prefetch" href="/website/assets/js/115.aa9431f2.js"><link rel="prefetch" href="/website/assets/js/116.4a1f8d02.js"><link rel="prefetch" href="/website/assets/js/118.de3f6cd7.js"><link rel="prefetch" href="/website/assets/js/119.1cf388a5.js"><link rel="prefetch" href="/website/assets/js/12.39daec44.js"><link rel="prefetch" href="/website/assets/js/120.c304e492.js"><link rel="prefetch" href="/website/assets/js/121.e6e7a438.js"><link rel="prefetch" href="/website/assets/js/122.2b30f637.js"><link rel="prefetch" href="/website/assets/js/123.5cab7947.js"><link rel="prefetch" href="/website/assets/js/124.7ab1beb8.js"><link rel="prefetch" href="/website/assets/js/125.7a04a783.js"><link rel="prefetch" href="/website/assets/js/126.cec1f5fe.js"><link rel="prefetch" href="/website/assets/js/127.ab3036a6.js"><link rel="prefetch" href="/website/assets/js/128.90c2378f.js"><link rel="prefetch" href="/website/assets/js/129.91a05c61.js"><link rel="prefetch" href="/website/assets/js/13.a49a78d4.js"><link rel="prefetch" href="/website/assets/js/130.0b7abc70.js"><link rel="prefetch" href="/website/assets/js/131.a4af2749.js"><link rel="prefetch" href="/website/assets/js/132.8518d9c6.js"><link rel="prefetch" href="/website/assets/js/133.9382449b.js"><link rel="prefetch" href="/website/assets/js/134.cd85131d.js"><link rel="prefetch" href="/website/assets/js/135.29ae6dd5.js"><link rel="prefetch" href="/website/assets/js/136.53901f75.js"><link rel="prefetch" href="/website/assets/js/137.6ddfed62.js"><link rel="prefetch" href="/website/assets/js/138.36b9b40d.js"><link rel="prefetch" href="/website/assets/js/139.164cc421.js"><link rel="prefetch" href="/website/assets/js/14.028bbd56.js"><link rel="prefetch" href="/website/assets/js/15.d0cb9e4d.js"><link rel="prefetch" href="/website/assets/js/16.3d3ce17c.js"><link rel="prefetch" href="/website/assets/js/17.4ca05b49.js"><link rel="prefetch" href="/website/assets/js/18.c6597664.js"><link rel="prefetch" href="/website/assets/js/19.2a72c605.js"><link rel="prefetch" href="/website/assets/js/20.996ea54f.js"><link rel="prefetch" href="/website/assets/js/21.2962c0d3.js"><link rel="prefetch" href="/website/assets/js/22.8bfb8ff6.js"><link rel="prefetch" href="/website/assets/js/23.9c351403.js"><link rel="prefetch" href="/website/assets/js/24.20bd2b52.js"><link rel="prefetch" href="/website/assets/js/25.9ea88fef.js"><link rel="prefetch" href="/website/assets/js/26.b119d6b4.js"><link rel="prefetch" href="/website/assets/js/27.03d4f779.js"><link rel="prefetch" href="/website/assets/js/28.b15856c0.js"><link rel="prefetch" href="/website/assets/js/29.f602d3ce.js"><link rel="prefetch" href="/website/assets/js/3.88d52878.js"><link rel="prefetch" href="/website/assets/js/30.04f867af.js"><link rel="prefetch" href="/website/assets/js/31.cea5c9b6.js"><link rel="prefetch" href="/website/assets/js/32.1631d468.js"><link rel="prefetch" href="/website/assets/js/33.3e48eefc.js"><link rel="prefetch" href="/website/assets/js/34.26eca9de.js"><link rel="prefetch" href="/website/assets/js/35.9b046a1c.js"><link rel="prefetch" href="/website/assets/js/36.f0010a9b.js"><link rel="prefetch" href="/website/assets/js/37.9faa0690.js"><link rel="prefetch" href="/website/assets/js/38.f2542146.js"><link rel="prefetch" href="/website/assets/js/39.0c23fbca.js"><link rel="prefetch" href="/website/assets/js/4.6cdd1aa1.js"><link rel="prefetch" href="/website/assets/js/40.1ad3dd31.js"><link rel="prefetch" href="/website/assets/js/41.f97fd808.js"><link rel="prefetch" href="/website/assets/js/42.a92f67ca.js"><link rel="prefetch" href="/website/assets/js/43.690cc19b.js"><link rel="prefetch" href="/website/assets/js/44.c62c5169.js"><link rel="prefetch" href="/website/assets/js/45.9e102c4c.js"><link rel="prefetch" href="/website/assets/js/46.b0feed9e.js"><link rel="prefetch" href="/website/assets/js/47.b514d671.js"><link rel="prefetch" href="/website/assets/js/48.5c98ec32.js"><link rel="prefetch" href="/website/assets/js/49.72484e05.js"><link rel="prefetch" href="/website/assets/js/5.01799cc0.js"><link rel="prefetch" href="/website/assets/js/50.60fb4626.js"><link rel="prefetch" href="/website/assets/js/51.750d5ede.js"><link rel="prefetch" href="/website/assets/js/52.fc0ed5ec.js"><link rel="prefetch" href="/website/assets/js/53.f0fd6c50.js"><link rel="prefetch" href="/website/assets/js/54.a0acaaf0.js"><link rel="prefetch" href="/website/assets/js/55.acb34351.js"><link rel="prefetch" href="/website/assets/js/56.12446451.js"><link rel="prefetch" href="/website/assets/js/57.42247331.js"><link rel="prefetch" href="/website/assets/js/58.dd30d720.js"><link rel="prefetch" href="/website/assets/js/59.6e112a6d.js"><link rel="prefetch" href="/website/assets/js/6.852d803a.js"><link rel="prefetch" href="/website/assets/js/60.6197bf91.js"><link rel="prefetch" href="/website/assets/js/61.d2ad5636.js"><link rel="prefetch" href="/website/assets/js/62.dfc3acd6.js"><link rel="prefetch" href="/website/assets/js/63.de7ef002.js"><link rel="prefetch" href="/website/assets/js/64.1beb1936.js"><link rel="prefetch" href="/website/assets/js/65.44532193.js"><link rel="prefetch" href="/website/assets/js/66.febb266e.js"><link rel="prefetch" href="/website/assets/js/67.70c24962.js"><link rel="prefetch" href="/website/assets/js/68.f0b65031.js"><link rel="prefetch" href="/website/assets/js/69.e9b738aa.js"><link rel="prefetch" href="/website/assets/js/7.3a413927.js"><link rel="prefetch" href="/website/assets/js/70.1d690124.js"><link rel="prefetch" href="/website/assets/js/71.b676ebd5.js"><link rel="prefetch" href="/website/assets/js/72.fbca8d96.js"><link rel="prefetch" href="/website/assets/js/73.3dd8cfbb.js"><link rel="prefetch" href="/website/assets/js/74.4851dd37.js"><link rel="prefetch" href="/website/assets/js/75.bf3d7617.js"><link rel="prefetch" href="/website/assets/js/76.5a9cf77c.js"><link rel="prefetch" href="/website/assets/js/77.dfc7549d.js"><link rel="prefetch" href="/website/assets/js/78.650f66aa.js"><link rel="prefetch" href="/website/assets/js/79.25cb1141.js"><link rel="prefetch" href="/website/assets/js/8.e905a1ae.js"><link rel="prefetch" href="/website/assets/js/80.e9581b2f.js"><link rel="prefetch" href="/website/assets/js/81.a3337503.js"><link rel="prefetch" href="/website/assets/js/82.d293671e.js"><link rel="prefetch" href="/website/assets/js/83.e831e12b.js"><link rel="prefetch" href="/website/assets/js/84.00ec0c67.js"><link rel="prefetch" href="/website/assets/js/85.15a32d73.js"><link rel="prefetch" href="/website/assets/js/86.9a355503.js"><link rel="prefetch" href="/website/assets/js/87.fae66a92.js"><link rel="prefetch" href="/website/assets/js/88.5ed2d5a7.js"><link rel="prefetch" href="/website/assets/js/89.ef74a881.js"><link rel="prefetch" href="/website/assets/js/9.5e42e36b.js"><link rel="prefetch" href="/website/assets/js/90.4c2285ca.js"><link rel="prefetch" href="/website/assets/js/91.07b99732.js"><link rel="prefetch" href="/website/assets/js/92.0e16b69d.js"><link rel="prefetch" href="/website/assets/js/93.467c66c9.js"><link rel="prefetch" href="/website/assets/js/94.a0a9006a.js"><link rel="prefetch" href="/website/assets/js/95.1cd10d8b.js"><link rel="prefetch" href="/website/assets/js/96.d4249770.js"><link rel="prefetch" href="/website/assets/js/97.f247dd95.js"><link rel="prefetch" href="/website/assets/js/98.e05a82fa.js"><link rel="prefetch" href="/website/assets/js/99.d5db74df.js">
    <link rel="stylesheet" href="/website/assets/css/0.styles.b8bf81b3.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/website/" class="home-link router-link-active"><!----> <span class="site-name">博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>ES6</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/website/es6/intro.html" class="sidebar-link">ECMAScript 6简介</a></li><li><a href="/website/es6/let.html" class="sidebar-link">let 和 const 命令</a></li><li><a href="/website/es6/destructuring.html" class="sidebar-link">变量的解构赋值</a></li><li><a href="/website/es6/string.html" class="sidebar-link">字符串的扩展</a></li><li><a href="/website/es6/string-methods.html" class="sidebar-link">字符串的新增方法</a></li><li><a href="/website/es6/regex.html" class="sidebar-link">正则的扩展</a></li><li><a href="/website/es6/number.html" class="sidebar-link">数值的扩展</a></li><li><a href="/website/es6/function.html" class="sidebar-link">函数的扩展</a></li><li><a href="/website/es6/array.html" class="sidebar-link">数组的扩展</a></li><li><a href="/website/es6/object.html" class="sidebar-link">对象的扩展</a></li><li><a href="/website/es6/object-methods.html" class="sidebar-link">对象的新增方法</a></li><li><a href="/website/es6/symbol.html" class="sidebar-link">Symbol</a></li><li><a href="/website/es6/set-map.html" class="sidebar-link">Set 和 Map 数据结构</a></li><li><a href="/website/es6/proxy.html" class="sidebar-link">Proxy</a></li><li><a href="/website/es6/reflect.html" class="sidebar-link">Reflect</a></li><li><a href="/website/es6/promise.html" class="sidebar-link">Promise 对象</a></li><li><a href="/website/es6/iterator.html" class="sidebar-link">Iterator 和 for...of 循环</a></li><li><a href="/website/es6/generator.html" class="sidebar-link">Generator 函数的语法</a></li><li><a href="/website/es6/generator-async.html" class="sidebar-link">Generator 函数的异步应用</a></li><li><a href="/website/es6/async.html" class="sidebar-link">async 函数</a></li><li><a href="/website/es6/class.html" class="sidebar-link">Class 的基本语法</a></li><li><a href="/website/es6/class-extends.html" class="sidebar-link">Class 的继承</a></li><li><a href="/website/es6/module.html" class="sidebar-link">Module 的语法</a></li><li><a href="/website/es6/module-loader.html" class="sidebar-link">Module 的加载实现</a></li><li><a href="/website/es6/style.html" class="sidebar-link">编程风格</a></li><li><a href="/website/es6/spec.html" class="sidebar-link">读懂规格</a></li><li><a href="/website/es6/async-iterator.html" class="sidebar-link">异步遍历器</a></li><li><a href="/website/es6/arraybuffer.html" class="sidebar-link">ArrayBuffer</a></li><li><a href="/website/es6/proposals.html" class="sidebar-link">最新提案</a></li><li><a href="/website/es6/decorator.html" class="sidebar-link">Decorator</a></li><li><a href="/website/es6/reference.html" class="sidebar-link">参考链接</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="二进制位运算符"><a href="#二进制位运算符" class="header-anchor">#</a> 二进制位运算符</h1> <h2 id="概述"><a href="#概述" class="header-anchor">#</a> 概述</h2> <p>二进制位运算符用于直接对二进制位进行计算，一共有7个。</p> <ul><li><strong>二进制或运算符</strong>（or）：符号为<code>|</code>，表示若两个二进制位都为<code>0</code>，则结果为<code>0</code>，否则为<code>1</code>。</li> <li><strong>二进制与运算符</strong>（and）：符号为<code>&amp;</code>，表示若两个二进制位都为1，则结果为1，否则为0。</li> <li><strong>二进制否运算符</strong>（not）：符号为<code>~</code>，表示对一个二进制位取反。</li> <li><strong>异或运算符</strong>（xor）：符号为<code>^</code>，表示若两个二进制位不相同，则结果为1，否则为0。</li> <li><strong>左移运算符</strong>（left shift）：符号为<code>&lt;&lt;</code>，详见下文解释。</li> <li><strong>右移运算符</strong>（right shift）：符号为<code>&gt;&gt;</code>，详见下文解释。</li> <li><strong>头部补零的右移运算符</strong>（zero filled right shift）：符号为<code>&gt;&gt;&gt;</code>，详见下文解释。</li></ul> <p>这些位运算符直接处理每一个比特位（bit），所以是非常底层的运算，好处是速度极快，缺点是很不直观，许多场合不能使用它们，否则会使代码难以理解和查错。</p> <p>有一点需要特别注意，位运算符只对整数起作用，如果一个运算子不是整数，会自动转为整数后再执行。另外，虽然在 JavaScript 内部，数值都是以64位浮点数的形式储存，但是做位运算的时候，是以32位带符号的整数进行运算的，并且返回值也是一个32位带符号的整数。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>i <span class="token operator">=</span> i <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">;</span>
</code></pre></div><p>上面这行代码的意思，就是将<code>i</code>（不管是整数或小数）转为32位整数。</p> <p>利用这个特性，可以写出一个函数，将任意数值转为32位整数。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">toInt32</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> x <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>上面这个函数将任意值与<code>0</code>进行一次或运算，这个位运算会自动将一个值转为32位整数。下面是这个函数的用法。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">toInt32</span><span class="token punctuation">(</span><span class="token number">1.001</span><span class="token punctuation">)</span> <span class="token comment">// 1</span>
<span class="token function">toInt32</span><span class="token punctuation">(</span><span class="token number">1.999</span><span class="token punctuation">)</span> <span class="token comment">// 1</span>
<span class="token function">toInt32</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">// 1</span>
<span class="token function">toInt32</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">// -1</span>
<span class="token function">toInt32</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">pow</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">// 1</span>
<span class="token function">toInt32</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">pow</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">// -1</span>
</code></pre></div><p>上面代码中，<code>toInt32</code>可以将小数转为整数。对于一般的整数，返回值不会有任何变化。对于大于或等于2的32次方的整数，大于32位的数位都会被舍去。</p> <h2 id="二进制或运算符"><a href="#二进制或运算符" class="header-anchor">#</a> 二进制或运算符</h2> <p>二进制或运算符（<code>|</code>）逐位比较两个运算子，两个二进制位之中只要有一个为<code>1</code>，就返回<code>1</code>，否则返回<code>0</code>。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token number">0</span> <span class="token operator">|</span> <span class="token number">3</span> <span class="token comment">// 3</span>
</code></pre></div><p>上面代码中，<code>0</code>和<code>3</code>的二进制形式分别是<code>00</code>和<code>11</code>，所以进行二进制或运算会得到<code>11</code>（即<code>3</code>）。</p> <p>位运算只对整数有效，遇到小数时，会将小数部分舍去，只保留整数部分。所以，将一个小数与<code>0</code>进行二进制或运算，等同于对该数去除小数部分，即取整数位。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token number">2.9</span> <span class="token operator">|</span> <span class="token number">0</span> <span class="token comment">// 2</span>
<span class="token operator">-</span><span class="token number">2.9</span> <span class="token operator">|</span> <span class="token number">0</span> <span class="token comment">// -2</span>
</code></pre></div><p>需要注意的是，这种取整方法不适用超过32位整数最大值<code>2147483647</code>的数。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token number">2147483649.4</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token comment">// -2147483647</span>
</code></pre></div><h2 id="二进制与运算符"><a href="#二进制与运算符" class="header-anchor">#</a> 二进制与运算符</h2> <p>二进制与运算符（<code>&amp;</code>）的规则是逐位比较两个运算子，两个二进制位之中只要有一个位为<code>0</code>，就返回<code>0</code>，否则返回<code>1</code>。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token number">0</span> <span class="token operator">&amp;</span> <span class="token number">3</span> <span class="token comment">// 0</span>
</code></pre></div><p>上面代码中，0（二进制<code>00</code>）和3（二进制<code>11</code>）进行二进制与运算会得到<code>00</code>（即<code>0</code>）。</p> <h2 id="二进制否运算符"><a href="#二进制否运算符" class="header-anchor">#</a> 二进制否运算符</h2> <p>二进制否运算符（<code>~</code>）将每个二进制位都变为相反值（<code>0</code>变为<code>1</code>，<code>1</code>变为<code>0</code>）。它的返回结果有时比较难理解，因为涉及到计算机内部的数值表示机制。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token operator">~</span> <span class="token number">3</span> <span class="token comment">// -4</span>
</code></pre></div><p>上面表达式对<code>3</code>进行二进制否运算，得到<code>-4</code>。之所以会有这样的结果，是因为位运算时，JavaScript 内部将所有的运算子都转为32位的二进制整数再进行运算。</p> <p><code>3</code>的32位整数形式是<code>00000000000000000000000000000011</code>，二进制否运算以后得到<code>11111111111111111111111111111100</code>。由于第一位（符号位）是1，所以这个数是一个负数。JavaScript 内部采用补码形式表示负数，即需要将这个数减去1，再取一次反，然后加上负号，才能得到这个负数对应的10进制值。这个数减去1等于<code>11111111111111111111111111111011</code>，再取一次反得到<code>00000000000000000000000000000100</code>，再加上负号就是<code>-4</code>。考虑到这样的过程比较麻烦，可以简单记忆成，一个数与自身的取反值相加，等于-1。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token operator">~</span> <span class="token operator">-</span><span class="token number">3</span> <span class="token comment">// 2</span>
</code></pre></div><p>上面表达式可以这样算，<code>-3</code>的取反值等于<code>-1</code>减去<code>-3</code>，结果为<code>2</code>。</p> <p>对一个整数连续两次二进制否运算，得到它自身。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token operator">~</span><span class="token operator">~</span><span class="token number">3</span> <span class="token comment">// 3</span>
</code></pre></div><p>所有的位运算都只对整数有效。二进制否运算遇到小数时，也会将小数部分舍去，只保留整数部分。所以，对一个小数连续进行两次二进制否运算，能达到取整效果。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token operator">~</span><span class="token operator">~</span><span class="token number">2.9</span> <span class="token comment">// 2</span>
<span class="token operator">~</span><span class="token operator">~</span><span class="token number">47.11</span> <span class="token comment">// 47</span>
<span class="token operator">~</span><span class="token operator">~</span><span class="token number">1.9999</span> <span class="token comment">// 1</span>
<span class="token operator">~</span><span class="token operator">~</span><span class="token number">3</span> <span class="token comment">// 3</span>
</code></pre></div><p>使用二进制否运算取整，是所有取整方法中最快的一种。</p> <p>对字符串进行二进制否运算，JavaScript 引擎会先调用<code>Number</code>函数，将字符串转为数值。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 相当于~Number('011')</span>
<span class="token operator">~</span><span class="token string">'011'</span>  <span class="token comment">// -12</span>

<span class="token comment">// 相当于~Number('42 cats')</span>
<span class="token operator">~</span><span class="token string">'42 cats'</span> <span class="token comment">// -1</span>

<span class="token comment">// 相当于~Number('0xcafebabe')</span>
<span class="token operator">~</span><span class="token string">'0xcafebabe'</span> <span class="token comment">// 889275713</span>

<span class="token comment">// 相当于~Number('deadbeef')</span>
<span class="token operator">~</span><span class="token string">'deadbeef'</span> <span class="token comment">// -1</span>
</code></pre></div><p><code>Number</code>函数将字符串转为数值的规则，参见《数据的类型转换》一章。</p> <p>对于其他类型的值，二进制否运算也是先用<code>Number</code>转为数值，然后再进行处理。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 相当于 ~Number([])</span>
<span class="token operator">~</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment">// -1</span>

<span class="token comment">// 相当于 ~Number(NaN)</span>
<span class="token operator">~</span><span class="token number">NaN</span> <span class="token comment">// -1</span>

<span class="token comment">// 相当于 ~Number(null)</span>
<span class="token operator">~</span><span class="token keyword">null</span> <span class="token comment">// -1</span>
</code></pre></div><h2 id="异或运算符"><a href="#异或运算符" class="header-anchor">#</a> 异或运算符</h2> <p>异或运算（<code>^</code>）在两个二进制位不同时返回<code>1</code>，相同时返回<code>0</code>。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token number">0</span> <span class="token operator">^</span> <span class="token number">3</span> <span class="token comment">// 3</span>
</code></pre></div><p>上面表达式中，<code>0</code>（二进制<code>00</code>）与<code>3</code>（二进制<code>11</code>）进行异或运算，它们每一个二进制位都不同，所以得到<code>11</code>（即<code>3</code>）。</p> <p>“异或运算”有一个特殊运用，连续对两个数<code>a</code>和<code>b</code>进行三次异或运算，<code>a^=b; b^=a; a^=b;</code>，可以<a href="http://en.wikipedia.org/wiki/XOR_swap_algorithm" target="_blank" rel="noopener noreferrer">互换<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>它们的值。这意味着，使用“异或运算”可以在不引入临时变量的前提下，互换两个变量的值。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token number">99</span><span class="token punctuation">;</span>

a <span class="token operator">^=</span> b<span class="token punctuation">,</span> b <span class="token operator">^=</span> a<span class="token punctuation">,</span> a <span class="token operator">^=</span> b<span class="token punctuation">;</span>

a <span class="token comment">// 99</span>
b <span class="token comment">// 10</span>
</code></pre></div><p>这是互换两个变量的值的最快方法。</p> <p>异或运算也可以用来取整。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token number">12.9</span> <span class="token operator">^</span> <span class="token number">0</span> <span class="token comment">// 12</span>
</code></pre></div><h2 id="左移运算符"><a href="#左移运算符" class="header-anchor">#</a> 左移运算符</h2> <p>左移运算符（<code>&lt;&lt;</code>）表示将一个数的二进制值向左移动指定的位数，尾部补<code>0</code>，即乘以<code>2</code>的指定次方。向左移动的时候，最高位的符号位是一起移动的。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 4 的二进制形式为100，</span>
<span class="token comment">// 左移一位为1000（即十进制的8）</span>
<span class="token comment">// 相当于乘以2的1次方</span>
<span class="token number">4</span> <span class="token operator">&lt;&lt;</span> <span class="token number">1</span>
<span class="token comment">// 8</span>

<span class="token operator">-</span><span class="token number">4</span> <span class="token operator">&lt;&lt;</span> <span class="token number">1</span>
<span class="token comment">// -8</span>
</code></pre></div><p>上面代码中，<code>-4</code>左移一位得到<code>-8</code>，是因为<code>-4</code>的二进制形式是<code>11111111111111111111111111111100</code>，左移一位后得到<code>11111111111111111111111111111000</code>，该数转为十进制（减去1后取反，再加上负号）即为<code>-8</code>。</p> <p>如果左移0位，就相当于将该数值转为32位整数，等同于取整，对于正数和负数都有效。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token number">13.5</span> <span class="token operator">&lt;&lt;</span> <span class="token number">0</span>
<span class="token comment">// 13</span>

<span class="token operator">-</span><span class="token number">13.5</span> <span class="token operator">&lt;&lt;</span> <span class="token number">0</span>
<span class="token comment">// -13</span>
</code></pre></div><p>左移运算符用于二进制数值非常方便。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> color <span class="token operator">=</span> <span class="token punctuation">{</span>r<span class="token operator">:</span> <span class="token number">186</span><span class="token punctuation">,</span> g<span class="token operator">:</span> <span class="token number">218</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">85</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// RGB to HEX</span>
<span class="token comment">// (1 &lt;&lt; 24)的作用为保证结果是6位数</span>
<span class="token keyword">var</span> <span class="token function-variable function">rgb2hex</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">r<span class="token punctuation">,</span> g<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token string">'#'</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>r <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>g <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">+</span> b<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span> <span class="token comment">// 先转成十六进制，然后返回字符串</span>
    <span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// 去除字符串的最高位，返回后面六个字符串</span>
<span class="token punctuation">}</span>

<span class="token function">rgb2hex</span><span class="token punctuation">(</span>color<span class="token punctuation">.</span>r<span class="token punctuation">,</span> color<span class="token punctuation">.</span>g<span class="token punctuation">,</span> color<span class="token punctuation">.</span>b<span class="token punctuation">)</span>
<span class="token comment">// &quot;#bada55&quot;</span>
</code></pre></div><p>上面代码使用左移运算符，将颜色的 RGB 值转为 HEX 值。</p> <h2 id="右移运算符"><a href="#右移运算符" class="header-anchor">#</a> 右移运算符</h2> <p>右移运算符（<code>&gt;&gt;</code>）表示将一个数的二进制值向右移动指定的位数。如果是正数，头部全部补<code>0</code>；如果是负数，头部全部补<code>1</code>。右移运算符基本上相当于除以<code>2</code>的指定次方（最高位即符号位参与移动）。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token number">4</span> <span class="token operator">&gt;&gt;</span> <span class="token number">1</span>
<span class="token comment">// 2</span>
<span class="token comment">/*
// 因为4的二进制形式为 00000000000000000000000000000100，
// 右移一位得到 00000000000000000000000000000010，
// 即为十进制的2
*/</span>

<span class="token operator">-</span><span class="token number">4</span> <span class="token operator">&gt;&gt;</span> <span class="token number">1</span>
<span class="token comment">// -2</span>
<span class="token comment">/*
// 因为-4的二进制形式为 11111111111111111111111111111100，
// 右移一位，头部补1，得到 11111111111111111111111111111110,
// 即为十进制的-2
*/</span>
</code></pre></div><p>右移运算可以模拟 2 的整除运算。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token number">5</span> <span class="token operator">&gt;&gt;</span> <span class="token number">1</span>
<span class="token comment">// 2</span>
<span class="token comment">// 相当于 5 / 2 = 2</span>

<span class="token number">21</span> <span class="token operator">&gt;&gt;</span> <span class="token number">2</span>
<span class="token comment">// 5</span>
<span class="token comment">// 相当于 21 / 4 = 5</span>

<span class="token number">21</span> <span class="token operator">&gt;&gt;</span> <span class="token number">3</span>
<span class="token comment">// 2</span>
<span class="token comment">// 相当于 21 / 8 = 2</span>

<span class="token number">21</span> <span class="token operator">&gt;&gt;</span> <span class="token number">4</span>
<span class="token comment">// 1</span>
<span class="token comment">// 相当于 21 / 16 = 1</span>
</code></pre></div><h2 id="头部补零的右移运算符"><a href="#头部补零的右移运算符" class="header-anchor">#</a> 头部补零的右移运算符</h2> <p>头部补零的右移运算符（<code>&gt;&gt;&gt;</code>）与右移运算符（<code>&gt;&gt;</code>）只有一个差别，就是一个数的二进制形式向右移动时，头部一律补零，而不考虑符号位。所以，该运算总是得到正值。对于正数，该运算的结果与右移运算符（<code>&gt;&gt;</code>）完全一致，区别主要在于负数。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token number">4</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">1</span>
<span class="token comment">// 2</span>

<span class="token operator">-</span><span class="token number">4</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">1</span>
<span class="token comment">// 2147483646</span>
<span class="token comment">/*
// 因为-4的二进制形式为11111111111111111111111111111100，
// 带符号位的右移一位，得到01111111111111111111111111111110，
// 即为十进制的2147483646。
*/</span>
</code></pre></div><p>这个运算实际上将一个值转为32位无符号整数。</p> <p>查看一个负整数在计算机内部的储存形式，最快的方法就是使用这个运算符。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token operator">-</span><span class="token number">1</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">0</span> <span class="token comment">// 4294967295</span>
</code></pre></div><p>上面代码表示，<code>-1</code>作为32位整数时，内部的储存形式使用无符号整数格式解读，值为 4294967295（即<code>(2^32)-1</code>，等于<code>11111111111111111111111111111111</code>）。</p> <h2 id="开关作用"><a href="#开关作用" class="header-anchor">#</a> 开关作用</h2> <p>位运算符可以用作设置对象属性的开关。</p> <p>假定某个对象有四个开关，每个开关都是一个变量。那么，可以设置一个四位的二进制数，它的每个位对应一个开关。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> <span class="token constant">FLAG_A</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">// 0001</span>
<span class="token keyword">var</span> <span class="token constant">FLAG_B</span> <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token comment">// 0010</span>
<span class="token keyword">var</span> <span class="token constant">FLAG_C</span> <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span> <span class="token comment">// 0100</span>
<span class="token keyword">var</span> <span class="token constant">FLAG_D</span> <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span> <span class="token comment">// 1000</span>
</code></pre></div><p>上面代码设置 A、B、C、D 四个开关，每个开关分别占有一个二进制位。</p> <p>然后，就可以用二进制与运算，检查当前设置是否打开了指定开关。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> flags <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span> <span class="token comment">// 二进制的0101</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>flags <span class="token operator">&amp;</span> <span class="token constant">FLAG_C</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
<span class="token comment">// 0101 &amp; 0100 =&gt; 0100 =&gt; true</span>
</code></pre></div><p>上面代码检验是否打开了开关<code>C</code>。如果打开，会返回<code>true</code>，否则返回<code>false</code>。</p> <p>现在假设需要打开<code>A</code>、<code>B</code>、<code>D</code>三个开关，我们可以构造一个掩码变量。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> mask <span class="token operator">=</span> <span class="token constant">FLAG_A</span> <span class="token operator">|</span> <span class="token constant">FLAG_B</span> <span class="token operator">|</span> <span class="token constant">FLAG_D</span><span class="token punctuation">;</span>
<span class="token comment">// 0001 | 0010 | 1000 =&gt; 1011</span>
</code></pre></div><p>上面代码对<code>A</code>、<code>B</code>、<code>D</code>三个变量进行二进制或运算，得到掩码值为二进制的<code>1011</code>。</p> <p>有了掩码，二进制或运算可以确保打开指定的开关。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>flags <span class="token operator">=</span> flags <span class="token operator">|</span> mask<span class="token punctuation">;</span>
</code></pre></div><p>上面代码中，计算后得到的<code>flags</code>变量，代表三个开关的二进制位都打开了。</p> <p>二进制与运算可以将当前设置中凡是与开关设置不一样的项，全部关闭。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>flags <span class="token operator">=</span> flags <span class="token operator">&amp;</span> mask<span class="token punctuation">;</span>
</code></pre></div><p>异或运算可以切换（toggle）当前设置，即第一次执行可以得到当前设置的相反值，再执行一次又得到原来的值。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>flags <span class="token operator">=</span> flags <span class="token operator">^</span> mask<span class="token punctuation">;</span>
</code></pre></div><p>二进制否运算可以翻转当前设置，即原设置为<code>0</code>，运算后变为<code>1</code>；原设置为<code>1</code>，运算后变为<code>0</code>。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>flags <span class="token operator">=</span> <span class="token operator">~</span>flags<span class="token punctuation">;</span>
</code></pre></div><h2 id="参考链接"><a href="#参考链接" class="header-anchor">#</a> 参考链接</h2> <ul><li>Michal Budzynski, <a href="http://michalbe.blogspot.co.uk/2013/03/javascript-less-known-parts-bitwise.html" target="_blank" rel="noopener noreferrer">JavaScript: The less known parts. Bitwise Operators<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>Axel Rauschmayer, <a href="http://www.2ality.com/2013/06/basic-javascript.html" target="_blank" rel="noopener noreferrer">Basic JavaScript for the impatient programmer<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>Mozilla Developer Network, <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Bitwise_Operators" target="_blank" rel="noopener noreferrer">Bitwise Operators<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/website/assets/js/app.e9cfb13d.js" defer></script><script src="/website/assets/js/2.9fa17cc6.js" defer></script><script src="/website/assets/js/117.8d5581c2.js" defer></script>
  </body>
</html>
